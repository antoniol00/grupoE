CREATE TABLE ASIGNATURA (REFERENCIA INTEGER NOT NULL, DTYPE VARCHAR(31), CARACTER VARCHAR(255), CODIGO INTEGER NOT NULL, CREDITOS_PRACTICOS DOUBLE NOT NULL, CREDITOS_TEORICOS DOUBLE NOT NULL, CUATRIMESTRE INTEGER, CURSO INTEGER, DURACION INTEGER, IDIOMAS VARCHAR(255), NOMBRE VARCHAR(255) NOT NULL, OFERTADA TINYINT(1) default 0 NOT NULL, TITULACION_CODIGO INTEGER NOT NULL, PRIMARY KEY (REFERENCIA))
CREATE TABLE OPTATIVA (REFERENCIA INTEGER NOT NULL, MENCION VARCHAR(255), PLAZAS INTEGER, PRIMARY KEY (REFERENCIA))
CREATE TABLE ALUMNO (DNI VARCHAR(9) NOT NULL, CODIGO_POSTAL INTEGER, DIRECCION_NOTIFICACION VARCHAR(255), EMAIL_INSTITUCIONAL VARCHAR(255) NOT NULL, EMAIL_PERSONAL VARCHAR(255), LOCALIDAD_NOTIFICACION VARCHAR(64), NOMBRE_COMPLETO VARCHAR(255) NOT NULL, PROVINCIA_NOTIFICACION VARCHAR(32), TELEFONO_FIJO INTEGER, TELEFONO_MOVIL INTEGER, PRIMARY KEY (DNI))
CREATE TABLE EXPEDIENTE (NUMERO INTEGER NOT NULL, ACTIVO TINYINT(1) default 0, CREDITOS_FB INTEGER, CREDITOS_OB INTEGER, CREDITOS_PE INTEGER, CREDITOS_TF INTEGER, NOTA_MEDIA DOUBLE, ALUMNO_DNI VARCHAR(9) NOT NULL, TITULACION_CODIGO INTEGER NOT NULL, PRIMARY KEY (NUMERO))
CREATE TABLE ENCUESTA (FECHA_ENVIO DATE NOT NULL, EXPEDIENTE_NUMERO INTEGER NOT NULL, PRIMARY KEY (FECHA_ENVIO, EXPEDIENTE_NUMERO))
CREATE TABLE GRUPOS_ASIG (CURSO VARCHAR(5) NOT NULL, OFERTA VARCHAR(10), ASIGNATURA_REFERENCIA_REFERENCIA INTEGER NOT NULL, GRUPO_ID_ID VARCHAR(255) NOT NULL, PRIMARY KEY (CURSO, ASIGNATURA_REFERENCIA_REFERENCIA, GRUPO_ID_ID))
CREATE TABLE MATRICULA (CURSO VARCHAR(10) NOT NULL, ACTIVA TINYINT(1) default 0 NOT NULL, FECHA_MATRICULA DATE, LISTADO_ASIGNATURAS VARCHAR(255), NUEVO_INGRESO TINYINT(1) default 0, NUMERO_ARCHIVO INTEGER NOT NULL UNIQUE, TIPO_ESTUDIO VARCHAR(10), TURNO VARCHAR(6), EXPEDIENTE_NUMERO INTEGER NOT NULL, PRIMARY KEY (CURSO, EXPEDIENTE_NUMERO))
CREATE TABLE GRUPO (ID VARCHAR(255) NOT NULL, ASIGNAR VARCHAR(255), CURSO INTEGER NOT NULL UNIQUE, INGLES TINYINT(1) default 0 NOT NULL, LETRA VARCHAR(1) NOT NULL UNIQUE, PLAZAS INTEGER, TURNO VARCHAR(6) NOT NULL, VISIBLE TINYINT(1) default 0, GRUPO_ID_ID VARCHAR(255), TITULACION_CODIGO INTEGER NOT NULL, PRIMARY KEY (ID))
CREATE TABLE CENTRO (NOMBRE VARCHAR(255) NOT NULL, DIRECCION VARCHAR(255), TLF_CONSERJERIA INTEGER, PRIMARY KEY (NOMBRE))
CREATE TABLE TITULACION (CODIGO INTEGER NOT NULL, CREDITOS INTEGER NOT NULL, NOMBRE VARCHAR(255) NOT NULL, PRIMARY KEY (CODIGO))
CREATE TABLE ASIGNA_GRUPOS (ASIGNATURA_REFERENCIA INTEGER NOT NULL, GRUPO_ID_ID VARCHAR(255), CURSO VARCHAR(10) NOT NULL, EXPEDIENTE_NUMERO INTEGER NOT NULL, PRIMARY KEY (ASIGNATURA_REFERENCIA, CURSO, EXPEDIENTE_NUMERO))
CREATE TABLE CLASE (HORA_INICIO VARCHAR(255) NOT NULL, DIA VARCHAR(255) NOT NULL, HORA_FIN VARCHAR(255) NOT NULL, ASIGNATURA_REFERENCIA INTEGER NOT NULL, GRUPO_ID_ID VARCHAR(255) NOT NULL, PRIMARY KEY (HORA_INICIO, DIA, GRUPO_ID_ID))
CREATE TABLE encuesta_grupos (fecha_envio DATE NOT NULL, expediente VARCHAR(255) NOT NULL, curso VARCHAR(5) NOT NULL, grupo VARCHAR(255) NOT NULL, asignatura VARCHAR(255) NOT NULL, PRIMARY KEY (fecha_envio, expediente, curso, grupo, asignatura))
CREATE TABLE titul_centro (centro_fk VARCHAR(255) NOT NULL, titulacion_fk INTEGER NOT NULL, PRIMARY KEY (centro_fk, titulacion_fk))
ALTER TABLE ASIGNATURA ADD CONSTRAINT FK_ASIGNATURA_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE OPTATIVA ADD CONSTRAINT FK_OPTATIVA_REFERENCIA FOREIGN KEY (REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_ALUMNO_DNI FOREIGN KEY (ALUMNO_DNI) REFERENCES ALUMNO (DNI)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE ENCUESTA ADD CONSTRAINT FK_ENCUESTA_EXPEDIENTE_NUMERO FOREIGN KEY (EXPEDIENTE_NUMERO) REFERENCES EXPEDIENTE (NUMERO)
ALTER TABLE GRUPOS_ASIG ADD CONSTRAINT FK_GRUPOS_ASIG_ASIGNATURA_REFERENCIA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE GRUPOS_ASIG ADD CONSTRAINT FK_GRUPOS_ASIG_GRUPO_ID_ID FOREIGN KEY (GRUPO_ID_ID) REFERENCES GRUPO (ID)
ALTER TABLE MATRICULA ADD CONSTRAINT FK_MATRICULA_EXPEDIENTE_NUMERO FOREIGN KEY (EXPEDIENTE_NUMERO) REFERENCES EXPEDIENTE (NUMERO)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_GRUPO_ID_ID FOREIGN KEY (GRUPO_ID_ID) REFERENCES GRUPO (ID)
ALTER TABLE ASIGNA_GRUPOS ADD CONSTRAINT FK_ASIGNA_GRUPOS_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE ASIGNA_GRUPOS ADD CONSTRAINT FK_ASIGNA_GRUPOS_CURSO FOREIGN KEY (CURSO, EXPEDIENTE_NUMERO) REFERENCES MATRICULA (CURSO, EXPEDIENTE_NUMERO)
ALTER TABLE ASIGNA_GRUPOS ADD CONSTRAINT FK_ASIGNA_GRUPOS_GRUPO_ID_ID FOREIGN KEY (GRUPO_ID_ID) REFERENCES GRUPO (ID)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_GRUPO_ID_ID FOREIGN KEY (GRUPO_ID_ID) REFERENCES GRUPO (ID)
ALTER TABLE encuesta_grupos ADD CONSTRAINT FK_encuesta_grupos_fecha_envio FOREIGN KEY (fecha_envio, expediente) REFERENCES ENCUESTA (FECHA_ENVIO, expediente)
ALTER TABLE encuesta_grupos ADD CONSTRAINT FK_encuesta_grupos_curso FOREIGN KEY (curso, grupo, asignatura) REFERENCES GRUPOS_ASIG (CURSO, grupo_id, asignatura_referencia)
ALTER TABLE titul_centro ADD CONSTRAINT FK_titul_centro_centro_fk FOREIGN KEY (centro_fk) REFERENCES CENTRO (NOMBRE)
ALTER TABLE titul_centro ADD CONSTRAINT FK_titul_centro_titulacion_fk FOREIGN KEY (titulacion_fk) REFERENCES TITULACION (CODIGO)
